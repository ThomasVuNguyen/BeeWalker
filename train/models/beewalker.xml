<!--
BeeWalker Bipedal Robot Model
Designed to match the physical robot with stacked servo blocks.

Based on actual robot photos:
- Tall torso box (electronics housing) with "head" spike
- Each leg: 3 servos stacked vertically in purple mounts
- Yellow 3D printed body segments
- Flat feet at bottom
-->
<mujoco model="beewalker">
    <compiler angle="degree" coordinate="local" inertiafromgeom="true"/>
    
    <option timestep="0.002" iterations="10" solver="Newton" integrator="RK4"/>
    
    <default>
        <joint limited="true" damping="1.0" armature="0.02"/>
        <geom contype="1" conaffinity="1" condim="3" friction="1.2 0.8 0.5" 
              density="800" margin="0.001"/>
        <motor ctrllimited="true" ctrlrange="-1 1"/>
    </default>
    
    <asset>
        <texture type="skybox" builtin="gradient" rgb1="0.4 0.5 0.6" rgb2="0.1 0.1 0.15" width="512" height="512"/>
        <texture name="texplane" type="2d" builtin="checker" rgb1="0.3 0.35 0.4" rgb2="0.15 0.2 0.25" 
                 width="512" height="512"/>
        <material name="MatPlane" texture="texplane" texrepeat="20 20" reflectance="0.3"/>
        <material name="MatBody" rgba="0.95 0.85 0.2 1"/>  <!-- Yellow body -->
        <material name="MatServo" rgba="0.6 0.4 0.7 1"/>   <!-- Purple servo mounts -->
        <material name="MatFoot" rgba="0.3 0.3 0.3 1"/>    <!-- Dark feet -->
    </asset>
    
    <worldbody>
        <!-- Lighting -->
        <light name="spotlight" mode="targetbodycom" target="torso" pos="0 -2 2" diffuse="0.9 0.9 0.9"/>
        <light name="fill" pos="2 2 3" diffuse="0.4 0.4 0.4"/>
        
        <!-- Ground plane -->
        <geom name="floor" type="plane" size="20 20 0.1" material="MatPlane" conaffinity="1" condim="3"/>
        
        <!-- Robot body -->
        <body name="torso" pos="0 0 0.40">
            <camera name="track" mode="trackcom" pos="0 -0.8 0.3" xyaxes="1 0 0 0 0.3 1"/>
            <freejoint name="root"/>
            
            <!-- Main torso - tall electronics box -->
            <geom name="torso_box" type="box" size="0.045 0.035 0.07" pos="0 0 0" material="MatBody"/>
            
            <!-- Head/spike decoration -->
            <geom name="head_spike" type="box" size="0.02 0.015 0.025" pos="0 0 0.095" material="MatBody"/>
            
            <!-- IMU sensor site -->
            <site name="imu_site" pos="0 0 0" size="0.005"/>
            
            <!-- ========== LEFT LEG ========== -->
            <body name="left_hip_block" pos="0.035 0 -0.07">
                <!-- Hip servo (servo 0) - rotates the upper leg -->
                <joint name="left_hip" type="hinge" axis="0 1 0" range="-45 45" ref="0"/>
                <geom name="left_hip_servo" type="box" size="0.025 0.02 0.025" pos="0 0 0" material="MatServo"/>
                
                <body name="left_upper_leg" pos="0 0 -0.05">
                    <!-- Upper leg segment -->
                    <geom name="left_upper_block" type="box" size="0.022 0.018 0.025" pos="0 0 0" material="MatBody"/>
                    
                    <body name="left_knee_block" pos="0 0 -0.05">
                        <!-- Knee servo (servo 1) -->
                        <joint name="left_knee" type="hinge" axis="0 1 0" range="-60 60" ref="0"/>
                        <geom name="left_knee_servo" type="box" size="0.025 0.02 0.025" pos="0 0 0" material="MatServo"/>
                        
                        <body name="left_lower_leg" pos="0 0 -0.05">
                            <!-- Lower leg segment -->
                            <geom name="left_lower_block" type="box" size="0.022 0.018 0.025" pos="0 0 0" material="MatBody"/>
                            
                            <body name="left_ankle_block" pos="0 0 -0.05">
                                <!-- Ankle servo (servo 2) -->
                                <joint name="left_ankle" type="hinge" axis="0 1 0" range="-30 30" ref="0"/>
                                <geom name="left_ankle_servo" type="box" size="0.025 0.02 0.025" pos="0 0 0" material="MatServo"/>
                                
                                <body name="left_foot" pos="0 0 -0.035">
                                    <!-- Foot -->
                                    <geom name="left_foot_geom" type="box" size="0.045 0.03 0.01" pos="0.01 0 0" material="MatFoot"/>
                                </body>
                            </body>
                        </body>
                    </body>
                </body>
            </body>
            
            <!-- ========== RIGHT LEG ========== -->
            <body name="right_hip_block" pos="-0.035 0 -0.07">
                <!-- Hip servo (servo 4) - rotates the upper leg -->
                <joint name="right_hip" type="hinge" axis="0 1 0" range="-45 45" ref="0"/>
                <geom name="right_hip_servo" type="box" size="0.025 0.02 0.025" pos="0 0 0" material="MatServo"/>
                
                <body name="right_upper_leg" pos="0 0 -0.05">
                    <!-- Upper leg segment -->
                    <geom name="right_upper_block" type="box" size="0.022 0.018 0.025" pos="0 0 0" material="MatBody"/>
                    
                    <body name="right_knee_block" pos="0 0 -0.05">
                        <!-- Knee servo (servo 5) -->
                        <joint name="right_knee" type="hinge" axis="0 1 0" range="-60 60" ref="0"/>
                        <geom name="right_knee_servo" type="box" size="0.025 0.02 0.025" pos="0 0 0" material="MatServo"/>
                        
                        <body name="right_lower_leg" pos="0 0 -0.05">
                            <!-- Lower leg segment -->
                            <geom name="right_lower_block" type="box" size="0.022 0.018 0.025" pos="0 0 0" material="MatBody"/>
                            
                            <body name="right_ankle_block" pos="0 0 -0.05">
                                <!-- Ankle servo (servo 6) -->
                                <joint name="right_ankle" type="hinge" axis="0 1 0" range="-30 30" ref="0"/>
                                <geom name="right_ankle_servo" type="box" size="0.025 0.02 0.025" pos="0 0 0" material="MatServo"/>
                                
                                <body name="right_foot" pos="0 0 -0.035">
                                    <!-- Foot -->
                                    <geom name="right_foot_geom" type="box" size="0.045 0.03 0.01" pos="0.01 0 0" material="MatFoot"/>
                                </body>
                            </body>
                        </body>
                    </body>
                </body>
            </body>
        </body>
    </worldbody>
    
    <actuator>
        <!-- Servo motors - position controlled like real MG996R servos -->
        <!-- Left leg: PCA9685 channels 0, 1, 2 -->
        <position name="servo_left_hip" joint="left_hip" kp="25" ctrlrange="-45 45"/>
        <position name="servo_left_knee" joint="left_knee" kp="25" ctrlrange="-60 60"/>
        <position name="servo_left_ankle" joint="left_ankle" kp="20" ctrlrange="-30 30"/>
        
        <!-- Right leg: PCA9685 channels 4, 5, 6 -->
        <position name="servo_right_hip" joint="right_hip" kp="25" ctrlrange="-45 45"/>
        <position name="servo_right_knee" joint="right_knee" kp="25" ctrlrange="-60 60"/>
        <position name="servo_right_ankle" joint="right_ankle" kp="20" ctrlrange="-30 30"/>
    </actuator>
    
    <sensor>
        <!-- IMU sensors -->
        <accelerometer name="accel" site="imu_site"/>
        <gyro name="gyro" site="imu_site"/>
        
        <!-- Joint position sensors -->
        <jointpos name="left_hip_pos" joint="left_hip"/>
        <jointpos name="left_knee_pos" joint="left_knee"/>
        <jointpos name="left_ankle_pos" joint="left_ankle"/>
        <jointpos name="right_hip_pos" joint="right_hip"/>
        <jointpos name="right_knee_pos" joint="right_knee"/>
        <jointpos name="right_ankle_pos" joint="right_ankle"/>
        
        <!-- Joint velocity sensors -->
        <jointvel name="left_hip_vel" joint="left_hip"/>
        <jointvel name="left_knee_vel" joint="left_knee"/>
        <jointvel name="left_ankle_vel" joint="left_ankle"/>
        <jointvel name="right_hip_vel" joint="right_hip"/>
        <jointvel name="right_knee_vel" joint="right_knee"/>
        <jointvel name="right_ankle_vel" joint="right_ankle"/>
        
        <!-- Torso state -->
        <framepos name="torso_pos" objtype="body" objname="torso"/>
        <framequat name="torso_quat" objtype="body" objname="torso"/>
        <framelinvel name="torso_vel" objtype="body" objname="torso"/>
    </sensor>
</mujoco>
